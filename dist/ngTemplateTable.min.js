angular.module("ngTemplateTable",["ui.bootstrap","ngSanitize","nsPopover","angular.filter","ui.select2","LocalStorageModule"]).run(["paginationConfig",function(a){a.firstText="<<",a.previousText="<",a.nextText=">",a.lastText=">>"}]).directive("ngTemplateTable",["$templateCache","$compile","$filter","$sce","$http","$parse","$timeout",function(a,b,c,d,e,f,g){return{restrict:"AE",transclude:!0,scope:{type:"=",model:"=",paginate:"=",numperpage:"=",order:"=",search:"=",column:"=",actions:"=",expandOn:"="},template:'<ng-include src="getTemplateUrl()"  />',controller:["$scope","$element","$rootScope",function(a){a.getTemplateUrl=function(){return(""==a.type||void 0==a.type)&&(a.type="table"),a.type+".html"}}],link:function(a,d,e){function f(a,b,c){if(!a||0==a.length||!b||!c)return[];for(var d,e,f=[],g=[],h=a[0],i=h[b],j={},k=a.length,l=0,l=0;k>l;l++)h=a[l],h.level=0,i=h[b],j[i]=h,d=h[c],void 0!==d&&void 0!==j[d]?(e=j[d],e.children?e.children.push(h):e.children=[h]):g.push(i);for(var l=0;l<g.length;l++)f.push(j[g[l]]);return f}a.resp=angular.copy(a.model),a.data=angular.copy(a.model),a.$watch("model",function(){a.resp=a.model,a.data=a.model;var b=angular.copy(a.data);a.tree=f(b,"id","parentId")}),a.iconLeaf=e.iconLeaf||"glyphicon glyphicon-file",a.iconExpand=e.iconExpand||"glyphicon glyphicon-menu-down",a.iconCollapse=e.iconCollapse||"glyphicon glyphicon-menu-right",a.ghnumperpage=0,a.ghnumperpage=a.numperpage;a.ghfilter="",a.ghrev=!0,a.ordered_columns=[];var h=0;if(a.renderTable=function(){a.ordered_columns=[];for(var b in a.resp[0])if("$$hashKey"!==b&&"parentId"!==b&&"children"!==b&&"id"!==b&&"icon"!==b&&"edit"!==b&&"delete"!==b){for(var d=[],e=c("unique")(a.resp,b),f=0;f<e.length;f++){var g=c("filter")(a.omit,{id:b,data:e[f][b]},!0),i=!0;void 0!==g[0]&&(i=!1),d.push({value:e[f][b],state:i})}if(void 0===a.column)a.ordered_columns.push({id:b,name:b,field:b,displayName:b,inFilter:!0,inTable:!0,inTree:!0,items:d,filter:!0,sort:!0,order:!0,all:!0,type:"text",customHTML:"",orderColumn:0});else{var j=c("filter")(a.column,{data:b},!0);void 0!==j[0]&&(void 0==j[0].filter&&(j[0].filter=!0),void 0==j[0].sort&&(j[0].sort=!0),void 0==j[0].customHTML&&(j[0].customHTML=""),void 0==j[0].name&&(j[0].name=b),void 0==j[0].type&&(j[0].type="text"),void 0==j[0].inTable&&(j[0].inTable=!0),("edit"==j[0].i||"delete"==j[0].i)&&(j[0].type=j[0].i),j[0].order=a.column.indexOf(j[0])+1,a.ordered_columns.push({id:b,name:j[0].name,field:b,displayName:j[0].name,inFilter:j[0].inFilter,inTable:j[0].inTable,inTree:j[0].inTree,colType:"ngtemplate-"+j[0].colType,"class":j[0]["class"],filter:j[0].filter,sort:j[0].sort,items:d,all:!0,type:j[0].type,customHTML:j[0].customHTML,orderColumn:j[0].order}))}}h=a.ordered_columns.length},a.omit=[],a.selectAll=function(b,d){for(var e=c("filter")(a.ordered_columns,{id:b}),f=a.ordered_columns.indexOf(e[0]),g=0;g<a.ordered_columns[f].items.length;g++){a.ordered_columns[f].items[g].state=d;var h;if(h=d?b+'!=="'+a.ordered_columns[f].items[g].value+'"':b+'=="'+a.ordered_columns[f].items[g].value+'"',d)for(var e=c("filter")(a.omit,{id:b}),i=0;i<e.length;i++){var j=a.omit.indexOf(e[i]);a.omit.splice(j,1)}else a.omit.push({value:h,id:b,data:a.ordered_columns[f].items[g].value})}a.ghfilters()},a.ngFilterCheck=function(b,d,e){var f;if(f=e?b+'!=="'+d+'"':b+'=="'+d+'"',e){var g=c("filter")(a.omit,{id:b,data:d}),h=a.omit.indexOf(g[0]);a.omit.splice(h,1)}else a.omit.push({value:f,id:b,data:d});a.ghfilters()},a.ghsearch="",a.ghfiltername="",a.ghOrder=function(b){a.ghrev=!a.ghrev,a.ghfiltername=b,a.ghfilters()},1==a.search){var i='<div class="row" ><div class="col-md-2" ng-template-number-per-page ></div><div class="col-md-4"></div>';if(i+='<div class="col-md-6" ng-template-search ng-show=" type!=\'pivot\'"></div>',i+='<hr><div class="col-md-12">',1==a.order){i+='<div class="btn-group" ng-show="type!=\'table\' && type!=\'tree\'  && type!=\'pivot\'" role="group" aria-label="...">';var j='<div btn-order-filter data="ordered_columns"></div>';i+=j,i+="</div>"}i+="</div><hr/></div>",d.prepend(b(i)(a))}if(1==a.paginate){a.ghtotalItems=a.resp.length,a.ghcurrentPage=1;var i='<div class="text-right" ng-show="type!=\'tree\' && type!=\'pivot\'"><pagination boundary-links="true" items-per-page="ghnumperpage" ng-change="ghfilters()" total-items="ghtotalItems" ng-model="ghcurrentPage" ></pagination></div>';d.append(b(i)(a))}a.internal=!1,a.ghfilters=function(){if(a.internal=!0,0==a.resp.length&&(a.resp=a.data),1==a.search&&(a.data=c("filtro2")(a.resp,a.ghsearch)),a.omit.length>0)for(var b=0;b<a.omit.length;b++)a.data=c("omit")(a.data,a.omit[b].value);if(1==a.paginate&&"tree"!=a.type){var d=(a.ghcurrentPage-1)*a.ghnumperpage,e=d+a.ghnumperpage;a.data=a.data.slice(d,e)}if(a.ghtotalItems=a.resp.length,"tree"==a.type){var h=angular.copy(a.data);a.tree=a.ghsearch.length<2?f(h,"id","parentId"):h}1==a.order&&(a.data=c("orderBy")(a.data,a.ghfiltername,a.ghrev)),g(function(){a.internal=!1})},a.$watch("data",function(){a.internal===!1&&(a.ghfilters(),a.renderTable())},!0);var k=angular.copy(a.data);a.tree=f(k,"id","parentId"),a.$watch("type",function(){("table"==a.type||"tree"==a.type)&&(a.renderTable(),"tree"==a.type&&a.runtree())}),a.runtree=function(){},a.toggleChildren=function(a){a.childrenVisible=!a.childrenVisible,a.folderClass=a.childrenVisible?"fa-folder-open":"fa-folder"},a.treefn=function(){},a.ghnumberPerPage=[3,5,10,20,30,40];a.getStretchedColumnWidth=function(){for(var a=0,b=window.outerWidth,c=0;h>c;c++)a+=b;var d=b/a;return b*=d},a.$watch("ghsearch",function(){a.ghfilters()},!0),a.$watch("column",function(){a.renderTable(),a.ghfilters()},!0)}}}]),angular.module("ngTemplateTable").directive("btnOrderFilter",function(){return{restrict:"A",replace:!0,transclude:!0,scope:{data:"="},templateUrl:"buttom-filter.html",link:function(){}}}),angular.module("ngTemplateTable").filter("capitalize",function(){return function(a,b){if(!a)return a;if(b=b||"all","first"===b)return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();var c=a.split(" "),d=[];return c.forEach(function(a){d.push(2===a.length&&"team"===b?a.toUpperCase():a.charAt(0).toUpperCase()+a.slice(1).toLowerCase())}),d.join(" ")}}).filter("filtro2",["$filter",function(a){return function(b,c){if(void 0==c&&(c=""),!Array.isArray(c)){for(var c=c.replace(/^\s+/,""),d=c.length-1;d>=0;d--)if(/\S/.test(c.charAt(d))){c=c.substring(0,d+1);break}var e=c.split(/\s+/).map(function(a){return a.replace(/^\W+/,"").replace(/\W+$/,"").toLowerCase()})}var f=Array(),g=0;return e.forEach(function(c){f=0==g?a("filter")(b,c):a("filter")(f,c),g++}),f}}]),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=b.numPages?c(b.numPages).assign:angular.noop;this.init=function(f,g){e=f,this.config=g,e.$render=function(){d.render()},b.itemsPerPage?a.$parent.$watch(c(b.itemsPerPage),function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}):this.itemsPerPage=g.itemsPerPage},this.calculateTotalPages=function(){var b=this.itemsPerPage<1?1:Math.ceil(a.totalItems/this.itemsPerPage);return Math.max(b||0,1)},this.render=function(){a.page=parseInt(e.$viewValue,10)||1},a.selectPage=function(b){a.page!==b&&b>0&&b<=a.totalPages&&(e.$setViewValue(b),e.$render())},a.getText=function(b){return a[b+"Text"]||d.config[b+"Text"]},a.noPrevious=function(){return 1===a.page},a.noNext=function(){return a.page===a.totalPages},a.$watch("totalItems",function(){a.totalPages=d.calculateTotalPages()}),a.$parent.$watch("ghnumperpage",function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}),a.$watch("totalPages",function(b){f(a.$parent,b),a.page>b?a.selectPage(b):e.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(a,b){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",template:'<ul class="pagination"><li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li><li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li><li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li><li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li><li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li></ul>',replace:!0,link:function(c,d,e,f){function g(a,b,c){return{number:a,text:b,active:c}}function h(a,b){var c=[],d=1,e=b,f=angular.isDefined(k)&&b>k;f&&(l?(d=Math.max(a-Math.floor(k/2),1),e=d+k-1,e>b&&(e=b,d=e-k+1)):(d=(Math.ceil(a/k)-1)*k+1,e=Math.min(d+k-1,b)));for(var h=d;e>=h;h++){var i=g(h,h,h===a);c.push(i)}if(f&&!l){if(d>1){var j=g(d-1,"...",!1);c.unshift(j)}if(b>e){var m=g(e+1,"...",!1);c.push(m)}}return c}var i=f[0],j=f[1];if(j){var k=angular.isDefined(e.maxSize)?c.$parent.$eval(e.maxSize):b.maxSize,l=angular.isDefined(e.rotate)?c.$parent.$eval(e.rotate):b.rotate;c.boundaryLinks=angular.isDefined(e.boundaryLinks)?c.$parent.$eval(e.boundaryLinks):b.boundaryLinks,c.directionLinks=angular.isDefined(e.directionLinks)?c.$parent.$eval(e.directionLinks):b.directionLinks,i.init(j,b),e.maxSize&&c.$parent.$watch(a(e.maxSize),function(a){k=parseInt(a,10),i.render()});var m=i.render;i.render=function(){m(),c.page>0&&c.page<=c.totalPages&&(c.pages=h(c.page,c.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(a){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:'<ul class="pager"><li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li><li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li></ul>',replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&(b.align=angular.isDefined(d.align)?b.$parent.$eval(d.align):a.align,f.init(g,a))}}}]),angular.module("ngTemplateTable").run(["$templateCache",function(a){"use strict";a.put("buttom-filter.html",'<div class="btn-group" ng-repeat="btndata in data" ng-show="btndata.sort"><button type="button" ng-click="ghOrder(btndata.id)" class="btn btn-default"><span style="float: left;margin-right: 5px;opacity: 0.2" class="fa" ng-class="{\'fa-sort\':ghfiltername!=btndata.id,\'fa-sort-desc\':ghfiltername==btndata.id && ghrev,\'fa-sort-asc\':ghfiltername==btndata.id && !ghrev}">&nbsp;</span> {{btndata.name|capitalize}}</button> <button ns-popover ns-popover-template="popover-data.html" ns-popover-trigger="click" ns-popover-theme="ns-popover-list-theme" class="btn btn-default"><span class="caret"></span></button></div>'),a.put("numberPerPage.html",'<select class="form-control" ui-select2 ng-show="  type!=\'tree\'  && type!=\'pivot\'" ng-model="ghnumperpage" ng-change="ghfilters()"><option ng-repeat="d in ghnumberPerPage">{{d}}</option></select>'),a.put("pivot.html",'<div pivot="" data="data"></div>'),a.put("popover-data-table.html",'<ul class="list-group"><li class="list-group-item" ng-switch on="c.type"><input type="text" ng-model="c.search" ng-switch-default></li><li class="list-group-item2"><input type="checkbox" ng-change="selectAll(c.id,c.all)" ng-model="c.all">(Seleccionar Todos)</li><li class="list-group-item2" ng-repeat="d in c.items|filter:c.search"><input type="checkbox" ng-model="d.state" ng-change="ngFilterCheck(c.id,d.value,d.state)"> {{d.value}}</li></ul>'),a.put("popover-data-tree.html",'<ul class="list-group"><li class="list-group-item2"><input type="text" ng-model="col.search"></li><li class="list-group-item2"><input type="checkbox" ng-change="selectAll(col.id,col.all)" ng-model="col.all">(Seleccionar Todos)</li><li class="list-group-item2" ng-repeat="d in col.items|filter:col.search"><input type="checkbox" ng-model="d.state" ng-change="ngFilterCheck(col.id,d.value,d.state)"> {{d.value}}</li></ul>'),a.put("popover-data.html",'<ul class="list-group"><li class="list-group-item" ng-switch on="btndata.type"><input type="text" ng-model="btndata.search" ng-switch-default></li><li class="list-group-item2"><input type="checkbox" ng-change="selectAll(btndata.id,btndata.all)" ng-model="btndata.all">(Seleccionar Todos)</li><li class="list-group-item2" ng-repeat="d in btndata.items|filter:btndata.search"><input type="checkbox" ng-model="d.state" ng-change="ngFilterCheck(btndata.id,d.value,d.state)"> {{d.value}}</li></ul>'),a.put("popover-window.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen, fade: animation }"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title" ng-bind="title" ng-show="title"></h3><div class="popover-content" tooltip-template-transclude></div></div></div>'),a.put("search.html",'<form class="form-horizontal"><div class="form-group has-feedback"><label class="control-label col-sm-3" for="inputSuccess3">Buscar</label><div class="col-sm-9"><input type="text" class="form-control" id="inputSuccess3" ng-model="ghsearch"> <span class="glyphicon glyphicon-search form-control-feedback" aria-hidden="true"></span> <span id="inputSuccess3Status" class="sr-only">(success)</span></div></div></form>'),a.put("table.html",'<table class="table table-bordered table-condensed table-striped table-hover"><thead><tr><th style="cursor: pointer" ng-show="c.inTable" ng-repeat="c in ordered_columns|orderBy:\'orderColumn\'" class="{{c.class}}"><i style="float: left;margin-right: 5px;opacity: 0.2" class="fa" ng-class="{\'fa-sort\':ghfiltername!=c.id && c.order==true,\'fa-sort-desc\':ghfiltername==c.id && ghrev  && c.order==true,\'fa-sort-asc\':ghfiltername==c.id && !ghrev  && c.order==true}"></i><div style="position:relative" ng-show="c.filter==true"><div ns-popover class="ui-grid-column-menu-button" ns-popover-template="popover-data-table.html" ns-popover-trigger="click" ns-popover-hide-on-click="false" ns-popover-theme="ns-popover-tooltip-theme"><span class="caret"></span></div></div><p ng-click="ghOrder(c.id)" style="margin-left: 8px">{{ c.name|capitalize }}</p></th></tr><tbody><tr ng-repeat="value in data" class="animate-repeat"><td ng-repeat="c in ordered_columns|orderBy:\'orderColumn\'" ng-show="c.inTable" ng-switch on="c.type"><p ng-switch-when="text" class="{{c.colType}}">{{ value[c.id] }} <i ng-show="c.colType==\'ngtemplate-percentage\'">%</i></p><p ng-switch-when="date" class="{{c.colType}}">{{ value[c.id]|date:\'dd-MM-yyyy HH:mm:ss\' }}</p><p ng-switch-when="html" class="{{c.colType}}" ng-type-html="" content="value[c.id]"></p><p ng-switch-when="customhtml" class="{{c.colType}}" ng-type-html="" content="c.customHTML"></p><p ng-switch-when="sparkline" class="{{c.colType}}" sparkline="" data="value[c.id]"></p><p ng-switch-default class="{{c.colType}}" ng-type type="c.type" data="value[c.id]"></p></td></tr></tbody></thead></table>'),a.put("tree.html",'<tree-grid expand-on="expandOn" tree-data="tree" col-defs="ordered_columns" expand-level="2" iconleaf="iconLeaf" iconexpand="iconExpand" iconcollapse="iconCollapse"></tree-grid>'),a.put("treeComponent.html",'<div><table class="table table-bordered table-striped tree-grid"><thead class=""><tr><th class="{{colDefinitions[0].class}}">{{expandingPropertyName}}</th><th ng-repeat="col in colDefinitions" ng-if="col.field!==expandingProperty" ng-show="col.inTree" class="{{c.class}}">{{(col.displayName || col.field)|capitalize}}</th></tr></thead><tbody><tr ng-init="value=row.branch;" ng-repeat="row in tree_rows | filter:{visible:true} track by row.branch.uid" ng-class="\'level-\'+{{ row.level+(row.branch.selected ? \' active\':\'\')}}" class="tree-grid-row"><td class=""><a style="color:#000000" ng-click="user_clicks_branch(row.branch)"><i ng-class="row.tree_icon" ng-click="row.branch.expanded = !row.branch.expanded" class="indented tree-icon"></i> <i ng-class="row.tree_icon_value" class="indented tree-icon"></i></a><span class="indented tree-label" ng-click="user_clicks_branch(row.branch)">{{row.branch[expandingProperty]}}</span></td><td ng-if="col.field!==expandingProperty" ng-show="col.inTree" ng-repeat="col in colDefinitions" ng-switch on="col.type"><p ng-switch-when="text" class="{{col.colType}}">{{ row.branch[col.id] }} <i ng-show="col.colType==\'ngtemplate-percentage\'">%</i></p><p ng-switch-when="date" class="{{col.colType}}">{{ row.branch[col.id] }}</p><p ng-switch-when="html" class="{{col.colType}}" ng-type-html="" content="row.branch[col.id]"></p><p ng-switch-when="customhtml" class="{{col.colType}}" ng-type-html="" content="col.customHTML"></p><p ng-switch-when="sparkline" class="{{col.colType}}" sparkline="" data="row.branch[col.id]"></p><p ng-switch-default class="{{col.colType}}" ng-type type="col.type" data="row.branch[col.id]"></p></td></tr></tbody></table></div>'),a.put("type-progress.html",'<div class="progress"><div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {{data}}%"><span class="sr-only">{{data}} Complete</span></div></div>')}]),angular.module("ngTemplateTable").directive("treeRow",function(){return{restrict:"AE",replace:!0,transclude:!0,scope:{data:"="},templateUrl:"tree-row.html",link:function(){}}}),angular.module("ngTemplateTable").directive("ngTypeHtml",["$parse","$compile",function(a,b){return{restrict:"AE",link:function(c,d,e){c.$watch(e.content,function(){d.html(a(e.content)(c)),b(d.contents())(c)},!0)}}}]),angular.module("ngTemplateTable").directive("ngType",function(){return{restrict:"AE",scope:{data:"=",type:"="},template:'<ng-include src="getTemplateUrl()"  />',controller:["$scope","$element",function(a){a.getTemplateUrl=function(){return"type-"+a.type+".html"}}],link:function(){}}}),angular.module("ngTemplateTable").directive("sparkline",function(){return{restrict:"AE",scope:{data:"="},link:function(a,b){a.$watch("data",function(){b.sparkline(a.data)})}}}),function(){var a;a=angular.module("ngTemplateTable"),a.directive("treeGrid",["$timeout",function(a){return{restrict:"E",templateUrl:"treeComponent.html",replace:!0,scope:{treeData:"=",colDefs:"=",expandOn:"=",onSelect:"&",initialSelection:"@",treeControl:"=",iconexpand:"=",iconcollapse:"=",iconleaf:"="},link:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(e=function(a){return void console.log("ERROR:"+a)},null==d.expandLevel&&(d.expandLevel="3"),h=parseInt(d.expandLevel,10),!b.treeData)return void alert("no treeData defined for the tree!");if(null==b.treeData.length){if(null==treeData.label)return void alert("treeData should be an array of root branches");b.treeData=[treeData]}for(var q=b.treeData[0],r=Object.keys(q),s=0,t=r.length;t>s;s++)if("string"==typeof q[r[s]]&&"id"!=r[s]&&"parentId"!=r[s]&&"icon"!=r[s]&&"edit"!=r[s]&&"delete"!=r[s]){f=r[s];break}if(f||(f=r[0]),b.expandingProperty=f,b.expandingPropertyName=b.expandOn?b.expandOn:b.expandingProperty,d.colDefs)b.colDefinitions=b.colDefs;else{var u=[],q=b.treeData[0],v=["children","level","expanded",f];for(var w in q)-1==v.indexOf(w)&&u.push({field:w});b.colDefinitions=u}return j=function(a){var c,d,e,f,g,h;for(c=function(b,d){var e,f,g,h,i;if(a(b,d),null!=b.children){for(h=b.children,i=[],f=0,g=h.length;g>f;f++)e=h[f],i.push(c(e,d+1));return i}},g=b.treeData,h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(c(d,1));return h},o=null,n=function(c){if(!c)return null!=o&&(o.selected=!1),void(o=null);if(c!==o){if(null!=o&&(o.selected=!1),c.selected=!0,o=c,g(c),null!=c.onSelect)return a(function(){return c.onSelect(c)});if(null!=b.onSelect)return a(function(){return b.onSelect({branch:c})})}},b.user_clicks_branch=function(a){return a!==o?n(a):void 0},k=function(a){var b;return b=void 0,a.parent_uid&&j(function(c){return c.uid===a.parent_uid?b=c:void 0}),b},i=function(a,b){var c;return c=k(a),null!=c?(b(c),i(c,b)):void 0},g=function(a){return i(a,function(a){return a.expanded=!0})},b.tree_rows=[],m=function(){var a,c,d,e,g,h;for(j(function(a){return a.uid?void 0:a.uid=""+Math.random()*Math.random()*Math.random()}),j(function(a){var b,c,d,e,f;if(angular.isArray(a.children)){for(e=a.children,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(b.parent_uid=a.uid);return f}}),b.tree_rows=[],j(function(a){var b,c;return a.children?a.children.length>0?(c=function(a){return"string"==typeof a?{label:a,children:[]}:a},a.children=function(){var d,e,f,g;for(f=a.children,g=[],d=0,e=f.length;e>d;d++)b=f[d],g.push(c(b));return g}()):void 0:a.children=[]}),a=function(c,d,e){var g,h,i,j,k,l,m;if(null==d.expanded&&(d.expanded=!1),i=d.children&&0!==d.children.length?d.expanded?b.iconcollapse:b.iconexpand:b.iconleaf,d.level=c,b.tree_rows.push({level:c,branch:d,label:d[f],tree_icon:i,tree_icon_value:d.icon,visible:e}),null!=d.children){for(l=d.children,m=[],j=0,k=l.length;k>j;j++)g=l[j],h=e&&d.expanded,m.push(a(c+1,g,h));return m}},g=b.treeData,h=[],d=0,e=g.length;e>d;d++)c=g[d],h.push(a(1,c,!0));return h},b.$watch("treeData",m,!0),null!=d.initialSelection&&j(function(b){return b.label===d.initialSelection?a(function(){return n(b)}):void 0}),l=b.treeData.length,j(function(a,b){return a.level=b,a.expanded=a.level<h}),null!=b.treeControl&&angular.isObject(b.treeControl)?(p=b.treeControl,p.expand_all=function(){return j(function(a){return a.expanded=!0})},p.collapse_all=function(){return j(function(a){return a.expanded=!1})},p.get_first_branch=function(){return l=b.treeData.length,l>0?b.treeData[0]:void 0},p.select_first_branch=function(){var a;return a=p.get_first_branch(),p.select_branch(a)},p.get_selected_branch=function(){return o},p.get_parent_branch=function(a){return k(a)},p.select_branch=function(a){return n(a),a},p.get_children=function(a){return a.children},p.select_parent_branch=function(a){var b;return null==a&&(a=p.get_selected_branch()),null!=a&&(b=p.get_parent_branch(a),null!=b)?(p.select_branch(b),b):void 0},p.add_branch=function(a,c){return null!=a?(a.children.push(c),a.expanded=!0):b.treeData.push(c),c},p.add_root_branch=function(a){return p.add_branch(null,a),a},p.expand_branch=function(a){return null==a&&(a=p.get_selected_branch()),null!=a?(a.expanded=!0,a):void 0},p.collapse_branch=function(a){return null==a&&(a=o),null!=a?(a.expanded=!1,a):void 0},p.get_siblings=function(a){var c,d;return null==a&&(a=o),null!=a?(c=p.get_parent_branch(a),d=c?c.children:b.treeData):void 0},p.get_next_sibling=function(a){var b,c;return null==a&&(a=o),null!=a&&(c=p.get_siblings(a),l=c.length,b=c.indexOf(a),l>b)?c[b+1]:void 0},p.get_prev_sibling=function(a){var b,c;return null==a&&(a=o),c=p.get_siblings(a),l=c.length,b=c.indexOf(a),b>0?c[b-1]:void 0},p.select_next_sibling=function(a){var b;return null==a&&(a=o),null!=a&&(b=p.get_next_sibling(a),null!=b)?p.select_branch(b):void 0},p.select_prev_sibling=function(a){var b;return null==a&&(a=o),null!=a&&(b=p.get_prev_sibling(a),null!=b)?p.select_branch(b):void 0},p.get_first_child=function(a){var b;return null==a&&(a=o),null!=a&&(null!=(b=a.children)?b.length:void 0)>0?a.children[0]:void 0},p.get_closest_ancestor_next_sibling=function(a){var b,c;return b=p.get_next_sibling(a),null!=b?b:(c=p.get_parent_branch(a),p.get_closest_ancestor_next_sibling(c))},p.get_next_branch=function(a){var b;return null==a&&(a=o),null!=a?(b=p.get_first_child(a),null!=b?b:b=p.get_closest_ancestor_next_sibling(a)):void 0},p.select_next_branch=function(a){var b;return null==a&&(a=o),null!=a&&(b=p.get_next_branch(a),null!=b)?(p.select_branch(b),b):void 0},p.last_descendant=function(a){var b;return l=a.children.length,0===l?a:(b=a.children[l-1],p.last_descendant(b))},p.get_prev_branch=function(a){var b,c;return null==a&&(a=o),null!=a?(c=p.get_prev_sibling(a),null!=c?p.last_descendant(c):b=p.get_parent_branch(a)):void 0},p.select_prev_branch=function(a){var b;return null==a&&(a=o),null!=a&&(b=p.get_prev_branch(a),null!=b)?(p.select_branch(b),b):void 0}):void 0}}}])}.call(this),angular.module("ngTemplateTable").directive("pivot",["localStorageService",function(a){return{restrict:"AE",scope:{data:"="},link:function(b,c){var d=$.extend($.pivotUtilities.renderers),e=a.get("pivot");null==e&&(e={roww:[],cols:[]}),$(c).pivotUI(b.data,{renderers:d,rendererName:"Table",cols:e.cols,rows:e.rows,onRefresh:function(c){var d=JSON.parse(JSON.stringify(c));delete d.aggregators,delete d.renderers,delete d.derivedAttributes,delete d.rendererOptions,delete d.localeStrings,a.set("pivot",d),b.$apply()}})}}}]),function(){var a,b=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},c=[].slice,d=function(a,b){return function(){return a.apply(b,arguments)}},e={}.hasOwnProperty;(a=function(a){return"object"==typeof exports&&"object"==typeof module?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return g=function(a,b,c){var d,e,f,g;for(a+="",e=a.split("."),f=e[0],g=e.length>1?c+e[1]:"",d=/(\d+)(\d{3})/;d.test(f);)f=f.replace(d,"$1"+b+"$2");return f+g},o=function(b){var c;return c={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",showZero:!1},b=a.extend(c,b),function(a){var c;return isNaN(a)||!isFinite(a)?"":0!==a||b.showZero?(c=g((b.scaler*a).toFixed(b.digitsAfterDecimal),b.thousandsSep,b.decimalSep),""+b.prefix+c+b.suffix):""}},r=o(),s=o({digitsAfterDecimal:0}),t=o({digitsAfterDecimal:1,scaler:100,suffix:"%"}),h={count:function(a){return null==a&&(a=s),function(){return function(){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:a}}}},countUnique:function(a){return null==a&&(a=s),function(c){var d;return d=c[0],function(){return{uniq:[],push:function(a){var c;return c=a[d],b.call(this.uniq,c)<0?this.uniq.push(a[d]):void 0},value:function(){return this.uniq.length},format:a,numInputs:null!=d?0:1}}}},listUnique:function(a){return function(c){var d;return d=c[0],function(){return{uniq:[],push:function(a){var c;return c=a[d],b.call(this.uniq,c)<0?this.uniq.push(a[d]):void 0},value:function(){return this.uniq.join(a)},format:function(a){return a},numInputs:null!=d?0:1}}}},sum:function(a){return null==a&&(a=r),function(b){var c;return c=b[0],function(){return{sum:0,push:function(a){return isNaN(parseFloat(a[c]))?void 0:this.sum+=parseFloat(a[c])},value:function(){return this.sum},format:a,numInputs:null!=c?0:1}}}},average:function(a){return null==a&&(a=r),function(b){var c;return c=b[0],function(){return{sum:0,len:0,push:function(a){return isNaN(parseFloat(a[c]))?void 0:(this.sum+=parseFloat(a[c]),this.len++)},value:function(){return this.sum/this.len},format:a,numInputs:null!=c?0:1}}}},sumOverSum:function(a){return null==a&&(a=r),function(b){var c,d;return d=b[0],c=b[1],function(){return{sumNum:0,sumDenom:0,push:function(a){return isNaN(parseFloat(a[d]))||(this.sumNum+=parseFloat(a[d])),isNaN(parseFloat(a[c]))?void 0:this.sumDenom+=parseFloat(a[c])},value:function(){return this.sumNum/this.sumDenom},format:a,numInputs:null!=d&&null!=c?0:2}}}},sumOverSumBound80:function(a,b){return null==a&&(a=!0),null==b&&(b=r),function(c){var d,e;return e=c[0],d=c[1],function(){return{sumNum:0,sumDenom:0,push:function(a){return isNaN(parseFloat(a[e]))||(this.sumNum+=parseFloat(a[e])),isNaN(parseFloat(a[d]))?void 0:this.sumDenom+=parseFloat(a[d])},value:function(){var b;return b=a?1:-1,(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*b*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:b,numInputs:null!=e&&null!=d?0:2}}}},fractionOf:function(a,b,d){return null==b&&(b="total"),null==d&&(d=t),function(){var e;return e=1<=arguments.length?c.call(arguments,0):[],function(c,f,g){return{selector:{total:[[],[]],row:[f,[]],col:[[],g]}[b],inner:a.apply(null,e)(c,f,g),push:function(a){return this.inner.push(a)},format:d,value:function(){return this.inner.value()/c.getAggregator.apply(c,this.selector).inner.value()},numInputs:a.apply(null,e)().numInputs}}}}},i=function(a){return{Count:a.count(s),"Count Unique Values":a.countUnique(s),"List Unique Values":a.listUnique(", "),Sum:a.sum(r),"Integer Sum":a.sum(s),Average:a.average(r),"Sum over Sum":a.sumOverSum(r),"80% Upper Bound":a.sumOverSumBound80(!0,r),"80% Lower Bound":a.sumOverSumBound80(!1,r),"Sum as Fraction of Total":a.fractionOf(a.sum(),"total",t),"Sum as Fraction of Rows":a.fractionOf(a.sum(),"row",t),"Sum as Fraction of Columns":a.fractionOf(a.sum(),"col",t),"Count as Fraction of Total":a.fractionOf(a.count(),"total",t),"Count as Fraction of Rows":a.fractionOf(a.count(),"row",t),"Count as Fraction of Columns":a.fractionOf(a.count(),"col",t)}}(h),q={Table:function(a,b){return p(a,b)},"Table Barchart":function(b,c){return a(p(b,c)).barchart()},Heatmap:function(b,c){return a(p(b,c)).heatmap()},"Row Heatmap":function(b,c){return a(p(b,c)).heatmap("rowheatmap")},"Col Heatmap":function(b,c){return a(p(b,c)).heatmap("colheatmap")}},l={en:{aggregators:i,renderers:q,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter results",totals:"Totals",vs:"vs",by:"by"}}},m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],u=function(a){return("0"+a).substr(-2,2)},k={bin:function(a,b){return function(c){return c[a]-c[a]%b}},dateFormat:function(a,b,c,d){return null==c&&(c=m),null==d&&(d=j),function(e){var f;return f=new Date(Date.parse(e[a])),isNaN(f)?"":b.replace(/%(.)/g,function(a,b){switch(b){case"y":return f.getFullYear();case"m":return u(f.getMonth()+1);case"n":return c[f.getMonth()];case"d":return u(f.getDate());case"w":return d[f.getDay()];case"x":return f.getDay();case"H":return u(f.getHours());case"M":return u(f.getMinutes());case"S":return u(f.getSeconds());default:return"%"+b}})}}},n=function(){return function(a,b){var c,d,e,f,g,h,i;if(h=/(\d+)|(\D+)/g,g=/\d/,i=/^0/,"number"==typeof a||"number"==typeof b)return isNaN(a)?1:isNaN(b)?-1:a-b;if(c=String(a).toLowerCase(),e=String(b).toLowerCase(),c===e)return 0;if(!g.test(c)||!g.test(e))return c>e?1:-1;for(c=c.match(h),e=e.match(h);c.length&&e.length;)if(d=c.shift(),f=e.shift(),d!==f)return g.test(d)&&g.test(f)?d.replace(i,".0")-f.replace(i,".0"):d>f?1:-1;return c.length-e.length}}(this),a.pivotUtilities={aggregatorTemplates:h,aggregators:i,renderers:q,derivers:k,locales:l,naturalSort:n,numberFormat:o},f=function(){function b(a,c){this.getAggregator=d(this.getAggregator,this),this.getRowKeys=d(this.getRowKeys,this),this.getColKeys=d(this.getColKeys,this),this.sortKeys=d(this.sortKeys,this),this.arrSort=d(this.arrSort,this),this.natSort=d(this.natSort,this),this.aggregator=c.aggregator,this.aggregatorName=c.aggregatorName,this.colAttrs=c.cols,this.rowAttrs=c.rows,this.valAttrs=c.vals,this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.sorted=!1,b.forEachRecord(a,c.derivedAttributes,function(a){return function(b){return c.filter(b)?a.processRecord(b):void 0}}(this))}return b.forEachRecord=function(b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q;if(f=a.isEmptyObject(c)?d:function(a){var b,e,f;for(b in c)e=c[b],a[b]=null!=(f=e(a))?f:a[b];return d(a)},a.isFunction(b))return b(f);if(a.isArray(b)){if(a.isArray(b[0])){p=[];
for(h in b)if(e.call(b,h)&&(g=b[h],h>0)){k={},o=b[0];for(i in o)e.call(o,i)&&(j=o[i],k[j]=g[i]);p.push(f(k))}return p}for(q=[],m=0,n=b.length;n>m;m++)k=b[m],q.push(f(k));return q}if(b instanceof jQuery)return l=[],a("thead > tr > th",b).each(function(){return l.push(a(this).text())}),a("tbody > tr",b).each(function(){return k={},a("td",this).each(function(b){return k[l[b]]=a(this).text()}),f(k)});throw new Error("unknown input format")},b.convertToArray=function(a){var c;return c=[],b.forEachRecord(a,{},function(a){return c.push(a)}),c},b.prototype.natSort=function(a,b){return n(a,b)},b.prototype.arrSort=function(a,b){return this.natSort(a.join(),b.join())},b.prototype.sortKeys=function(){return this.sorted||(this.rowKeys.sort(this.arrSort),this.colKeys.sort(this.arrSort)),this.sorted=!0},b.prototype.getColKeys=function(){return this.sortKeys(),this.colKeys},b.prototype.getRowKeys=function(){return this.sortKeys(),this.rowKeys},b.prototype.processRecord=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(b=[],e=[],k=this.colAttrs,g=0,i=k.length;i>g;g++)f=k[g],b.push(null!=(l=a[f])?l:"null");for(m=this.rowAttrs,h=0,j=m.length;j>h;h++)f=m[h],e.push(null!=(n=a[f])?n:"null");return d=e.join(String.fromCharCode(0)),c=b.join(String.fromCharCode(0)),this.allTotal.push(a),0!==e.length&&(this.rowTotals[d]||(this.rowKeys.push(e),this.rowTotals[d]=this.aggregator(this,e,[])),this.rowTotals[d].push(a)),0!==b.length&&(this.colTotals[c]||(this.colKeys.push(b),this.colTotals[c]=this.aggregator(this,[],b)),this.colTotals[c].push(a)),0!==b.length&&0!==e.length?(this.tree[d]||(this.tree[d]={}),this.tree[d][c]||(this.tree[d][c]=this.aggregator(this,e,b)),this.tree[d][c].push(a)):void 0},b.prototype.getAggregator=function(a,b){var c,d,e;return e=a.join(String.fromCharCode(0)),d=b.join(String.fromCharCode(0)),c=0===a.length&&0===b.length?this.allTotal:0===a.length?this.colTotals[d]:0===b.length?this.rowTotals[e]:this.tree[e][d],null!=c?c:{value:function(){return null},format:function(){return""}}},b}(),p=function(b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;j={localeStrings:{totals:"Totals"}},c=a.extend(j,c),g=b.colAttrs,o=b.rowAttrs,q=b.getRowKeys(),i=b.getColKeys(),n=document.createElement("table");var z=(document.createElement("thead"),document.createElement("tbody"));n.className="table table-bordered table-condensed table-striped table-hover ",r=function(a,b,c){var d,e,f,g,h,i;if(0!==b){for(e=!0,g=h=0;c>=0?c>=h:h>=c;g=c>=0?++h:--h)a[b-1][g]!==a[b][g]&&(e=!1);if(e)return-1}for(d=0;b+d<a.length;){for(f=!1,g=i=0;c>=0?c>=i:i>=c;g=c>=0?++i:--i)a[b][g]!==a[b+d][g]&&(f=!0);if(f)break;d++}return d};for(l in g)if(e.call(g,l)){f=g[l],v=document.createElement("tr"),0===parseInt(l)&&0!==o.length&&(t=document.createElement("th"),t.setAttribute("colspan",o.length),t.setAttribute("rowspan",g.length),v.appendChild(t)),t=document.createElement("th"),t.className="pvtAxisLabel",t.textContent=f,v.appendChild(t);for(k in i)e.call(i,k)&&(h=i[k],y=r(i,parseInt(k),parseInt(l)),-1!==y&&(t=document.createElement("th"),t.className="pvtColLabel",t.textContent=h[l],t.setAttribute("colspan",y),parseInt(l)===g.length-1&&0!==o.length&&t.setAttribute("rowspan",2),v.appendChild(t)));0===parseInt(l)&&(t=document.createElement("th"),t.className="pvtTotalLabel",t.innerHTML=c.localeStrings.totals,t.setAttribute("rowspan",g.length+(0===o.length?0:1)),v.appendChild(t)),z.appendChild(v)}if(0!==o.length){v=document.createElement("tr");for(k in o)e.call(o,k)&&(m=o[k],t=document.createElement("th"),t.className="pvtAxisLabel",t.textContent=m,v.appendChild(t));t=document.createElement("th"),0===g.length&&(t.className="pvtTotalLabel",t.innerHTML=c.localeStrings.totals),v.appendChild(t),z.appendChild(v)}for(k in q)if(e.call(q,k)){p=q[k],v=document.createElement("tr");for(l in p)e.call(p,l)&&(w=p[l],y=r(q,parseInt(k),parseInt(l)),-1!==y&&(t=document.createElement("td"),t.className="pvtRowLabel",t.textContent=w,t.setAttribute("rowspan",y),parseInt(l)===o.length-1&&0!==g.length&&t.setAttribute("colspan",2),v.appendChild(t)));for(l in i)e.call(i,l)&&(h=i[l],d=b.getAggregator(p,h),x=d.value(),s=document.createElement("td"),s.className="pvtVal row"+k+" col"+l,s.innerHTML=d.format(x),s.setAttribute("data-value",x),v.appendChild(s));u=b.getAggregator(p,[]),x=u.value(),s=document.createElement("td"),s.className="pvtTotal rowTotal",s.innerHTML=u.format(x),s.setAttribute("data-value",x),s.setAttribute("data-for","row"+k),v.appendChild(s),z.appendChild(v)}v=document.createElement("tr"),t=document.createElement("td"),t.className="pvtTotalLabel",t.innerHTML=c.localeStrings.totals,t.setAttribute("colspan",o.length+(0===g.length?0:1)),v.appendChild(t);for(l in i)e.call(i,l)&&(h=i[l],u=b.getAggregator([],h),x=u.value(),s=document.createElement("td"),s.className="pvtTotal colTotal",s.innerHTML=u.format(x),s.setAttribute("data-value",x),s.setAttribute("data-for","col"+l),v.appendChild(s));return u=b.getAggregator([],[]),x=u.value(),s=document.createElement("td"),s.className="pvtGrandTotal",s.innerHTML=u.format(x),s.setAttribute("data-value",x),v.appendChild(s),z.appendChild(v),n.appendChild(z),n.setAttribute("data-numrows",q.length),n.setAttribute("data-numcols",i.length),n},a.fn.pivot=function(b,c){var d,e,g,i,j;d={cols:[],rows:[],filter:function(){return!0},aggregator:h.count()(),aggregatorName:"Count",derivedAttributes:{},renderer:p,rendererOptions:null,localeStrings:l.en.localeStrings},c=a.extend(d,c),i=null;try{g=new f(b,c);try{i=c.renderer(g,c.rendererOptions)}catch(k){e=k,"undefined"!=typeof console&&null!==console&&console.error(e.stack),i=a("<span>").html(c.localeStrings.renderError)}}catch(k){e=k,"undefined"!=typeof console&&null!==console&&console.error(e.stack),i=a("<span>").html(c.localeStrings.computeError)}for(j=this[0];j.hasChildNodes();)j.removeChild(j.lastChild);return this.append(i)},a.fn.pivotUI=function(c,d,g,h){var i,j,k,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;null==g&&(g=!1),null==h&&(h="es"),q={derivedAttributes:{},aggregators:l[h].aggregators,renderers:l[h].renderers,hiddenAttributes:[],menuLimit:200,cols:[],rows:[],vals:[],exclusions:{},unusedAttrsVertical:"auto",autoSortUnusedAttrs:!1,rendererOptions:{localeStrings:l[h].localeStrings},onRefresh:null,filter:function(){return!0},localeStrings:l[h].localeStrings},s=this.data("pivotUIOptions"),w=null==s||g?a.extend(q,d):s;try{c=f.convertToArray(c),D=function(){var a,b;a=c[0],b=[];for(v in a)if("$$hashKey"!==v&&"id"!==v&&"parentId"!==v){if(!e.call(a,v))continue;b.push(v)}return b}(),T=w.derivedAttributes;for(o in T)e.call(T,o)&&b.call(D,o)<0&&D.push(o);for(m={},L=0,P=D.length;P>L;L++)J=D[L],m[J]={};f.forEachRecord(c,w.derivedAttributes,function(a){var b,c,d;d=[];for(v in a)if("$$hashKey"!==v&&"id"!==v&&"parentId"!==v){if(!e.call(a,v))continue;if(b=a[v],!w.filter(a))continue;null==b&&(b="null"),null==(c=m[v])[b]&&(c[b]=0),d.push(m[v][b]++)}return d}),G=a("<table class='table   table-bordered table-condensed table-striped table-hover' cellpadding='5'>"),H=a("<tbody>").appendTo(G),B=a("<td class='col-md-1'>"),A=a("<select class='pvtRenderer'>").appendTo(B).bind("change",function(){return y()}),U=w.renderers;for(J in U)e.call(U,J)&&a("<option>").val(J).html(J).appendTo(A);if(p=a("<td class='pvtAxisContainer pvtUnused'>"),C=function(){var a,c,d;for(d=[],a=0,c=D.length;c>a;a++)o=D[a],b.call(w.hiddenAttributes,o)<0&&d.push(o);return d}(),I=!1,"auto"===w.unusedAttrsVertical){for(k=0,M=0,Q=C.length;Q>M;M++)i=C[M],k+=i.length;I=k>120}p.addClass(w.unusedAttrsVertical===!0||I?"pvtVertList":"pvtHorizList"),K=function(c){var d,e,f,g,h,i,j,k,l,o,q,r,s,u,x;if(j=function(){var a;a=[];for(v in m[c])a.push(v);return a}(),i=!1,r=a("<div>").addClass("pvtFilterBox").hide(),r.append(a("<h4>").text(""+c+" ("+j.length+")")),j.length>w.menuLimit)r.append(a("<p>").html(w.localeStrings.tooMany));else for(e=a("<p>").appendTo(r),e.append(a("<button>").html(w.localeStrings.selectAll).bind("click",function(){return r.find("input:visible").prop("checked",!0)})),e.append(a("<button>").html(w.localeStrings.selectNone).bind("click",function(){return r.find("input:visible").prop("checked",!1)})),e.append(a("<input>").addClass("pvtSearch").attr("placeholder",w.localeStrings.filterResults).bind("keyup",function(){var b;return b=a(this).val().toLowerCase(),a(this).parents(".pvtFilterBox").find("label span").each(function(){var c;return c=a(this).text().toLowerCase().indexOf(b),-1!==c?a(this).parent().show():a(this).parent().hide()})})),f=a("<div>").addClass("pvtCheckContainer").appendTo(r),x=j.sort(n),s=0,u=x.length;u>s;s++)v=x[s],q=m[c][v],g=a("<label>"),h=w.exclusions[c]?b.call(w.exclusions[c],v)>=0:!1,i||(i=h),a("<input type='checkbox' class='pvtFilter'>").attr("checked",!h).data("filter",[c,v]).appendTo(g),g.append(a("<span>").text(""+v+" ("+q+")")),f.append(a("<p>").append(g));return o=function(){var b;return b=a(r).find("[type='checkbox']").length-a(r).find("[type='checkbox']:checked").length,b>0?d.addClass("pvtFilteredAttribute"):d.removeClass("pvtFilteredAttribute"),j.length>w.menuLimit?r.toggle():r.toggle(0,y)},a("<p>").appendTo(r).append(a("<button>").text("OK").bind("click",o)),k=function(b){return r.css({left:b.pageX,top:b.pageY}).toggle(),a(".pvtSearch").val(""),a("label").show()},l=a("<span class='pvtTriangle' style='color:white'>").html(" &#x25BE;").bind("click",k),d=a("<li class='axis_"+t+"'>").append(a("<span class='label label-info pvtAttr'>").text(c).data("attrName",c).append(l)),i&&d.addClass("pvtFilteredAttribute"),p.append(d).append(r),d.bind("dblclick",k)};for(t in C)o=C[t],K(o);E=a("<tr>").appendTo(H),j=a("<select class='pvtAggregator'>").bind("change",function(){return y()}),V=w.aggregators;for(J in V)e.call(V,J)&&j.append(a("<option>").val(J).html(J));for(a("<td class='pvtVals'>").appendTo(E).append(j).append(a("<br>")),a("<td class='pvtAxisContainer pvtHorizList pvtCols'>").appendTo(E),F=a("<tr>").appendTo(H),F.append(a("<td valign='top' class='pvtAxisContainer pvtRows'>")),x=a("<td valign='top' class='pvtRendererArea'>").appendTo(F),w.unusedAttrsVertical===!0||I?(G.find("tr:nth-child(1)").prepend(B),G.find("tr:nth-child(2)").prepend(p)):G.prepend(a("<tr>").append(B).append(p)),this.html(G),W=w.cols,N=0,R=W.length;R>N;N++)J=W[N],this.find(".pvtCols").append(this.find(".axis_"+C.indexOf(J)));for(X=w.rows,O=0,S=X.length;S>O;O++)J=X[O],this.find(".pvtRows").append(this.find(".axis_"+C.indexOf(J)));null!=w.aggregatorName&&this.find(".pvtAggregator").val(w.aggregatorName),null!=w.rendererName&&this.find(".pvtRenderer").val(w.rendererName),u=!0,z=function(d){return function(){var e,f,g,h,i,k,l,m,n,o,p,q,r,s;if(m={derivedAttributes:w.derivedAttributes,localeStrings:w.localeStrings,rendererOptions:w.rendererOptions,cols:[],rows:[]},i=null!=(s=w.aggregators[j.val()]([])().numInputs)?s:0,o=[],d.find(".pvtRows li span.pvtAttr").each(function(){return m.rows.push(a(this).data("attrName"))}),d.find(".pvtCols li span.pvtAttr").each(function(){return m.cols.push(a(this).data("attrName"))}),d.find(".pvtVals select.pvtAttrDropdown").each(function(){return 0===i?a(this).remove():(i--,""!==a(this).val()?o.push(a(this).val()):void 0)}),0!==i)for(l=d.find(".pvtVals"),J=q=0;i>=0?i>q:q>i;J=i>=0?++q:--q){for(h=a("<select class='pvtAttrDropdown'>").append(a("<option>")).bind("change",function(){return y()}),r=0,p=C.length;p>r;r++)e=C[r],h.append(a("<option>").val(e).text(e));l.append(h)}return u&&(o=w.vals,t=0,d.find(".pvtVals select.pvtAttrDropdown").each(function(){return a(this).val(o[t]),t++}),u=!1),m.aggregatorName=j.val(),m.vals=o,m.aggregator=w.aggregators[j.val()](o),m.renderer=w.renderers[A.val()],f={},d.find("input.pvtFilter").not(":checked").each(function(){var b;return b=a(this).data("filter"),null!=f[b[0]]?f[b[0]].push(b[1]):f[b[0]]=[b[1]]}),m.filter=function(a){var c,d;if(!w.filter(a))return!1;for(v in f)if(c=f[v],d=""+a[v],b.call(c,d)>=0)return!1;return!0},x.pivot(c,m),k=a.extend(w,{cols:m.cols,rows:m.rows,vals:o,exclusions:f,aggregatorName:j.val(),rendererName:A.val()}),d.data("pivotUIOptions",k),w.autoSortUnusedAttrs&&(g=a.pivotUtilities.naturalSort,n=d.find("td.pvtUnused.pvtAxisContainer"),a(n).children("li").sort(function(b,c){return g(a(b).text(),a(c).text())}).appendTo(n)),x.css("opacity",1),null!=w.onRefresh?w.onRefresh(k):void 0}}(this),y=function(){return function(){return x.css("opacity",.5),setTimeout(z,10)}}(this),y(),this.find(".pvtAxisContainer").sortable({update:function(a,b){return null==b.sender?y():void 0},connectWith:this.find(".pvtAxisContainer"),items:"li",placeholder:"pvtPlaceholder"})}catch(Y){r=Y,"undefined"!=typeof console&&null!==console&&console.error(r.stack),this.html(w.localeStrings.uiRenderError)}return this},a.fn.heatmap=function(b){var c,d,e,f,g,h,i,j;switch(null==b&&(b="heatmap"),h=this.data("numrows"),g=this.data("numcols"),c=function(a,b,c){var d;return d=function(){switch(a){case"red":return function(a){return"ff"+a+a};case"green":return function(a){return""+a+"ff"+a};case"blue":return function(a){return""+a+a+"ff"}}}(),function(a){var e,f;return f=255-Math.round(255*(a-b)/(c-b)),e=f.toString(16).split(".")[0],1===e.length&&(e=0+e),d(e)}},d=function(b){return function(d,e){var f,g,h;return g=function(c){return b.find(d).each(function(){var b;return b=a(this).data("value"),null!=b&&isFinite(b)?c(b,a(this)):void 0})},h=[],g(function(a){return h.push(a)}),f=c(e,Math.min.apply(Math,h),Math.max.apply(Math,h)),g(function(a,b){return b.css("background-color","#"+f(a))})}}(this),b){case"heatmap":d(".pvtVal","red");break;case"rowheatmap":for(e=i=0;h>=0?h>i:i>h;e=h>=0?++i:--i)d(".pvtVal.row"+e,"red");break;case"colheatmap":for(f=j=0;g>=0?g>j:j>g;f=g>=0?++j:--j)d(".pvtVal.col"+f,"red")}return d(".pvtTotal.rowTotal","red"),d(".pvtTotal.colTotal","red"),this},a.fn.barchart=function(){var b,c,d,e,f;for(e=this.data("numrows"),d=this.data("numcols"),b=function(b){return function(c){var d,e,f,g;return d=function(d){return b.find(c).each(function(){var b;return b=a(this).data("value"),null!=b&&isFinite(b)?d(b,a(this)):void 0})},g=[],d(function(a){return g.push(a)}),e=Math.max.apply(Math,g),f=function(a){return 100*a/(1.4*e)},d(function(b,c){var d,e;return d=c.text(),e=a("<div>").css({position:"relative",height:"55px"}),e.append(a("<div>").css({position:"absolute",bottom:0,left:0,right:0,height:f(b)+"%","background-color":"gray"})),e.append(a("<div>").text(d).css({position:"relative","padding-left":"5px","padding-right":"5px"})),c.css({padding:0,"padding-top":"5px","text-align":"center"}).html(e)})}}(this),c=f=0;e>=0?e>f:f>e;c=e>=0?++f:--f)b(".pvtVal.row"+c);return b(".pvtTotal.colTotal"),this}})}.call(this);var callWithJQuery;(callWithJQuery=function(a){return"object"==typeof exports&&"object"==typeof module?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){var b,c,d,e,f;return e=a.pivotUtilities.numberFormat,f=a.pivotUtilities.aggregatorTemplates,b=e({thousandsSep:" ",decimalSep:","}),c=e({digitsAfterDecimal:0,thousandsSep:" ",decimalSep:","}),d=e({digitsAfterDecimal:1,scaler:100,suffix:"%",thousandsSep:" ",decimalSep:","}),a.pivotUtilities.locales.es={localeStrings:{renderError:"Ocurri&oacute; un error durante la interpretaci&oacute;n de la tabla din&acute;mica.",computeError:"Ocurri&oacute; un error durante el c&acute;lculo de la tabla din&acute;mica.",uiRenderError:"Ocurri&oacute; un error durante el dibujado de la tabla din&acute;mica.",selectAll:"Seleccionar todo",selectNone:"Deseleccionar todo",tooMany:"(demasiados valores)",filterResults:"Filtrar resultados",totals:"Totales",vs:"vs",by:"por"},aggregators:{Cuenta:f.count(c),"Cuenta de valores &uacute;nicos":f.countUnique(c),"Lista de valores &uacute;nicos":f.listUnique(", "),Suma:f.sum(b),"Suma de enteros":f.sum(c),Promedio:f.average(b),"Suma de sumas":f.sumOverSum(b),"Cota 80% superior":f.sumOverSumBound80(!0,b),"Cota 80% inferior":f.sumOverSumBound80(!1,b),"Proporci&oacute;n del total (suma)":f.fractionOf(f.sum(),"total",d),"Proporci&oacute;n de la fila (suma)":f.fractionOf(f.sum(),"row",d),"Proporci&oacute;n de la columna (suma)":f.fractionOf(f.sum(),"col",d),"Proporci&oacute;n del total (cuenta)":f.fractionOf(f.count(),"total",d),"Proporci&oacute;n de la fila (cuenta)":f.fractionOf(f.count(),"row",d),"Proporci&oacute;n de la columna (cuenta)":f.fractionOf(f.count(),"col",d)},renderers:{Tabla:a.pivotUtilities.renderers.Table,"Tabla con barras":a.pivotUtilities.renderers["Table Barchart"],Heatmap:a.pivotUtilities.renderers.Heatmap,"Heatmap por filas":a.pivotUtilities.renderers["Row Heatmap"],"Heatmap por columnas":a.pivotUtilities.renderers["Col Heatmap"]}}});var callWithJQuery;(callWithJQuery=function(a){return"object"==typeof exports&&"object"==typeof module?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){var b;return b=function(b,c){return function(d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;for(k={localeStrings:{vs:"vs",by:"by"}},e=a.extend(k,e),v=d.getRowKeys(),0===v.length&&v.push([]),h=d.getColKeys(),0===h.length&&h.push([]),o=function(){var a,b,c;for(c=[],a=0,b=v.length;b>a;a++)m=v[a],c.push(m.join("-"));return c}(),o.unshift(""),q=0,i=[o],A=0,C=h.length;C>A;A++){for(g=h[A],t=[g.join("-")],q+=t[0].length,B=0,D=v.length;D>B;B++)u=v[B],f=d.getAggregator(u,g),t.push(null!=f.value()?f.value():null);i.push(t)}w=y=d.aggregatorName+(d.valAttrs.length?"("+d.valAttrs.join(", ")+")":""),n=d.colAttrs.join("-"),""!==n&&(w+=" "+e.localeStrings.vs+" "+n),l=d.rowAttrs.join("-"),""!==l&&(w+=" "+e.localeStrings.by+" "+l),r={width:a(window).width()/1.4,height:a(window).height()/1.4,title:w,hAxis:{title:n,slantedText:q>50},vAxis:{title:y}},2===i[0].length&&""===i[0][1]&&(r.legend={position:"none"});for(p in c)x=c[p],r[p]=x;return j=google.visualization.arrayToDataTable(i),s=a("<div style='width: 100%; height: 100%;'>"),z=new google.visualization.ChartWrapper({dataTable:j,chartType:b,options:r}),z.draw(s[0]),s.bind("dblclick",function(){var a;return a=new google.visualization.ChartEditor,google.visualization.events.addListener(a,"ok",function(){return a.getChartWrapper().draw(s[0])}),a.openDialog(z)}),s}},a.pivotUtilities.gchart_renderers={"Line Chart":b("LineChart"),"Bar Chart":b("ColumnChart"),"Stacked Bar Chart":b("ColumnChart",{isStacked:!0}),"Area Chart":b("AreaChart",{isStacked:!0})}});var callWithJQuery;callWithJQuery=function(a){return"object"==typeof exports&&"object"==typeof module?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)},callWithJQuery(function(a){return a.pivotUtilities.d3_renderers={Treemap:function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(f={localeStrings:{}},c=a.extend(f,c),i=a("<div style='width: 100%; height: 100%;'>"),k={name:"All",children:[]},d=function(a,b,c){var e,f,g,h,i,j;if(0===b.length)return void(a.value=c);for(null==a.children&&(a.children=[]),g=b.shift(),j=a.children,h=0,i=j.length;i>h;h++)if(e=j[h],e.name===g)return void d(e,b,c);return f={name:g},d(f,b,c),a.children.push(f)},q=b.getRowKeys(),o=0,p=q.length;p>o;o++)j=q[o],m=b.getAggregator(j,[]).value(),null!=m&&d(k,j,m);return e=d3.scale.category10(),n=a(window).width()/1.4,g=a(window).height()/1.4,h=10,l=d3.layout.treemap().size([n,g]).sticky(!0).value(function(a){return a.size}),d3.select(i[0]).append("div").style("position","relative").style("width",n+2*h+"px").style("height",g+2*h+"px").style("left",h+"px").style("top",h+"px").datum(k).selectAll(".node").data(l.padding([15,0,0,0]).value(function(a){return a.value}).nodes).enter().append("div").attr("class","node").style("background",function(a){return null!=a.children?"lightgrey":e(a.name)}).text(function(a){return a.name}).call(function(){this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return Math.max(0,a.dx-1)+"px"}).style("height",function(a){return Math.max(0,a.dy-1)+"px"})}),i}}}),angular.module("ngTemplateTable").directive("readMore",function(){return{restrict:"A",transclude:!0,replace:!0,template:"<p></p>",scope:{moreText:"@",lessText:"@",words:"@",ellipsis:"@","char":"@",limit:"@",content:"@"},link:function(a,b,c,d,e){function f(a){var a=a,d=a,e=/\s+/gi,f=a.length,k=a.trim().replace(e," ").split(" ").length,l="char",m=f,n=[],o=a,p="";angular.isUndefined(c.words)||(l="words",m=k),"words"===l?(n=a.split(/\s+/),n.length>j&&(a=n.slice(0,j).join(" ")+i,p=n.slice(j,m).join(" "),o=a+g+'<span class="more-text">'+p+h+"</span>")):m>j&&(a=d.slice(0,j)+i,p=d.slice(j,m),o=a+g+'<span class="more-text">'+p+h+"</span>"),b.append(o),b.find(".read-more").on("click",function(){$(this).hide(),b.find(".more-text").addClass("show").slideDown()}),b.find(".read-less").on("click",function(){b.find(".read-more").show(),b.find(".more-text").hide().removeClass("show")})}var g=angular.isUndefined(a.moreText)?' <a class="read-more">Ver Mas...</a>':' <a class="read-more">'+a.moreText+"</a>",h=angular.isUndefined(a.lessText)?' <a class="read-less">Ocultar ^</a>':' <a class="read-less">'+a.lessText+"</a>",i=angular.isUndefined(a.ellipsis)?"":a.ellipsis,j=angular.isUndefined(a.limit)?150:a.limit;c.$observe("content",function(a){f(a)}),e(a.$parent,function(a){f(a.text().trim())})}}}),angular.module("ngTemplateTable").directive("ngTemplateSearch",function(){return{restrict:"A",templateUrl:"search.html",link:function(){}}}),angular.module("ngTemplateTable").directive("ngTemplateNumberPerPage",function(){return{restrict:"A",templateUrl:"numberPerPage.html",link:function(){}}}),angular.module("ngTemplateTable").directive("datetimepicker",function(){function a(a,b){function c(a){return!(null===a||void 0===a||0/0===a||""===a)}return c(a)?a:b}return{restrict:"AE",replace:!0,scope:{ngModel:"=",format:"@",todayBtn:"@",weekStart:"@",minuteStep:"@"},template:'<div class="input-append date form_datetime">   <input size="16" type="text" value="" readonly>   <span class="add-on"><i class="icon-remove"></i></span>	<span class="add-on"><i class="icon-th"></i></span></div>',link:function(b,c){var d=$(c.children()[0]);d.datetimepicker({format:a(b.format,"d-m-yyyy"),weekStart:a(b.weekStart,"1"),todayBtn:"true"===a(b.todayBtn,"true"),minuteStep:parseInt(a(b.minuteStep,"5")),autoclose:1,todayHighlight:1,minView:2,language:"es",startView:"decade",autoclose:!0}).on("changeDate",function(a){b.$apply(function(){b.ngModel=a.date})}),b.$watch("ngModel",function(a){d.datetimepicker("update",a)})}}}),angular.module("ui.select2",[]).value("uiSelect2Config",{}).directive("uiSelect2",["uiSelect2Config","$timeout",function(a,b){var c={};return a&&angular.extend(c,a),{require:"ngModel",compile:function(a,d){a=$(a);var e,f,g,h=a.is("select"),i=angular.isDefined(d.multiple);return a.is("select")&&(f=a.find("option[ng-repeat], option[data-ng-repeat]"),f.length&&(g=f.attr("ng-repeat")||f.attr("data-ng-repeat"),e=jQuery.trim(g.split("|")[0]).split(" ").pop())),function(a,f,g,j){f=$(f);var k=angular.extend({},c,a.$eval(g.uiSelect2)),l=function(a){var b;return k.simple_tags?(b=[],angular.forEach(a,function(a){b.push(a.id)})):b=a,b},m=function(a){var b=[];return a?(k.simple_tags?(b=[],angular.forEach(a,function(a){b.push({id:a,text:a})})):b=a,b):b};if(h?(delete k.multiple,delete k.initSelection):i&&(k.multiple=!0),j&&(a.$watch(d.ngModel,function(a,b){a&&a!==b&&j.$render()},!0),j.$render=function(){if(h)f.select2("val",j.$viewValue);else if(k.multiple){var a=j.$viewValue;angular.isString(a)&&(a=a.split(",")),f.select2("data",m(a))}else angular.isObject(j.$viewValue)?f.select2("data",j.$viewValue):j.$viewValue?f.select2("val",j.$viewValue):f.select2("data",null)},e&&a.$watch(e,function(a,c){angular.equals(a,c)||b(function(){f.select2("val",j.$viewValue),f.trigger("change"),a&&!c&&j.$setPristine&&j.$setPristine(!0)})}),j.$parsers.push(function(a){var b=f.prev();return b.toggleClass("ng-invalid",!j.$valid).toggleClass("ng-valid",j.$valid).toggleClass("ng-invalid-required",!j.$valid).toggleClass("ng-valid-required",j.$valid).toggleClass("ng-dirty",j.$dirty).toggleClass("ng-pristine",j.$pristine),a}),!h&&(f.bind("change",function(b){b.stopImmediatePropagation(),a.$$phase||a.$root.$$phase||a.$apply(function(){j.$setViewValue(l(f.select2("data")))})}),k.initSelection))){var n=k.initSelection;k.initSelection=function(a,b){n(a,function(a){j.$setViewValue(l(a)),b(a)})}}f.bind("$destroy",function(){f.select2("destroy")}),g.$observe("disabled",function(a){f.select2("enable",!a)}),g.$observe("readonly",function(a){f.select2("readonly",!!a)}),g.ngMultiple&&a.$watch(g.ngMultiple,function(a){g.$set("multiple",!!a),f.select2(k)}),b(function(){f.select2(k),f.val(j.$viewValue),j.$render(),k.initSelection||h||j.$setViewValue(l(f.select2("data")))})}}}}]);